# 🎯 立即开始 - 快速部署指南

## ✅ 你现在需要做的事情（按顺序）

### 第1步：导入数据库（5分钟）⭐必须

打开PowerShell，执行：

```powershell
# 方法1：直接导入
mysql -u root -pLjqhcsk1@ < "d:\数据库\小组大作业\大作业.sql"

# 方法2：如果方法1报错，先登录再导入
mysql -u root -pLjqhcsk1@
```

如果使用方法2，在MySQL命令行中执行：
```sql
source d:/数据库/小组大作业/大作业.sql;
exit;
```

**或者使用Navicat图形化工具**：
1. 打开Navicat
2. 连接到MySQL
3. 右键数据库 → 运行SQL文件
4. 选择 `大作业.sql`
5. 点击开始

---

### 第2步：创建MySQL用户和权限（3分钟）⭐必须

```powershell
mysql -u root -pLjqhcsk1@ < "d:\数据库\小组大作业\创建用户和权限.sql"
```

这会创建6个专用的MySQL用户账号。

---

### 第3步：验证数据库（2分钟）

```powershell
mysql -u root -pLjqhcsk1@ -e "USE \`大作业-test4\`; SHOW TABLES;"
```

应该看到类似这样的输出：
```
+-------------------------+
| Tables_in_大作业-test4  |
+-------------------------+
| budget                  |
| costs                   |
| country                 |
| exchange                |
| history                 |
| model                   |
| ...                     |
+-------------------------+
```

---

### 第4步：安装Python依赖（2分钟）

```powershell
cd "d:\数据库\小组大作业\app"
pip install streamlit pymysql pandas openpyxl
```

---

### 第5步：运行应用（1分钟）🚀

```powershell
cd "d:\数据库\小组大作业\app"
streamlit run app.py
```

浏览器会自动打开：http://localhost:8501

---

## 🔐 测试登录

### 系统提供6个账号：

| 角色 | 用户名 | 密码 | 能看到什么 |
|------|--------|------|------------|
| 👨‍💼 管理者 | Manager | manager123 | 历史预测预算对比分析 |
| 💼 财务BP | FBP | fbp123 | 成本费用财务数据 |
| 🇮🇳 印度业务员 | Salesperson_India | india123 | 只有印度数据 |
| 🇵🇰 巴基斯坦业务员 | Salesperson_Pakistan | pakistan123 | 只有巴基斯坦数据 |
| 🇿🇦 南非业务员 | Salesperson_SouthAfrica | southafrica123 | 只有南非数据 |
| 🇰🇪 肯尼亚业务员 | Salesperson_Kenya | kenya123 | 只有肯尼亚数据 |

---

## 🧪 快速测试清单

### ✅ 测试1：管理者登录
1. 用户名：Manager
2. 密码：manager123
3. 应该能看到："数据分析对比"页面
4. 应该能看到完整的对比数据

### ✅ 测试2：印度业务员登录
1. 用户名：Salesperson_India
2. 密码：india123
3. 只能看到印度相关数据
4. 无法看到其他国家数据

### ✅ 测试3：权限隔离
```powershell
# 以印度业务员身份登录MySQL测试
mysql -u salesperson_india -pindia123456 大作业-test4

# 执行查询
SELECT * FROM DisplayIndia;  # ✅ 应该成功
SELECT * FROM DisplayPakistan;  # ❌ 应该报错（无权限）
```

---

## ⚙️ 配置说明

### 当前配置（推荐）：

`app/config.py` 中：
```python
USE_DB_ROLES = True  # 使用MySQL用户权限
```

这是**最完整的配置**，展示了：
- ✅ 数据库层权限控制
- ✅ 视图权限设计
- ✅ 角色隔离
- ✅ 专业的权限管理

### 如果遇到问题，可以临时切换：

```python
USE_DB_ROLES = False  # 使用应用层权限（更简单）
```

---

## 🎬 答辩演示脚本（10分钟）

### 第1部分：系统介绍（2分钟）

**说辞**：
> "我们开发了一个销售数据分析系统，采用Python + Streamlit + MySQL架构。
> 系统实现了完整的权限管理，包括数据库层和应用层两层权限控制。
> 我们为不同职能创建了专门的MySQL用户和视图，确保数据安全。"

### 第2部分：权限演示（3分钟）

**操作**：
1. 登录Manager账号 → 展示对比分析功能
2. 登出，登录Salesperson_India → 展示只能看印度数据
3. 在命令行演示：
   ```powershell
   mysql -u salesperson_india -pindia123456 大作业-test4
   SELECT * FROM DisplayPakistan;  # 报错：无权限
   ```

**说辞**：
> "不同角色看到的数据完全不同，这是通过MySQL的Role和视图实现的。
> 业务员只能访问本国的视图，无法查看其他国家数据。"

### 第3部分：功能演示（3分钟）

1. 数据查询 - 展示筛选功能
2. 数据分析 - 展示预算实际对比
3. 报表生成 - 导出Excel

### 第4部分：技术亮点（2分钟）

**要点**：
- 数据库设计：11张表 + 多层视图结构
- 权限设计：6个Role + 对应的MySQL用户
- 视图层次：基础视图 → 计算视图 → 权限视图
- 应用集成：Streamlit自动切换数据库用户

---

## 📊 系统架构图

```
┌─────────────────────────────────────────┐
│         Streamlit Web应用                │
│  (用户登录 + 应用层权限控制)              │
└─────────────┬───────────────────────────┘
              │
              │ 根据角色切换MySQL用户
              ↓
┌─────────────────────────────────────────┐
│          MySQL数据库                     │
│                                          │
│  ┌────────────────────────────────┐    │
│  │ 用户: manager_user             │    │
│  │ 权限: 查看 s_Display 视图      │    │
│  └────────────────────────────────┘    │
│                                          │
│  ┌────────────────────────────────┐    │
│  │ 用户: salesperson_india        │    │
│  │ 权限: 查看 DisplayIndia 视图   │    │
│  └────────────────────────────────┘    │
│                                          │
│  [ 基础表: History, Budget, Sales... ]  │
│  [ 视图: Display, DisplayIndia... ]     │
└─────────────────────────────────────────┘
```

---

## ❗ 常见问题快速解决

### ❌ 问题1：无法连接数据库

**解决**：
```powershell
# 检查MySQL是否运行
mysql -u root -pLjqhcsk1@ -e "SELECT 1;"

# 检查数据库是否存在
mysql -u root -pLjqhcsk1@ -e "SHOW DATABASES;"
```

### ❌ 问题2：用户权限错误

**解决**：
```powershell
# 重新执行权限脚本
mysql -u root -pLjqhcsk1@ < "d:\数据库\小组大作业\创建用户和权限.sql"
```

### ❌ 问题3：Streamlit报错

**解决**：
```powershell
# 清除缓存重启
# 先按 Ctrl+C 停止
streamlit cache clear
streamlit run app.py
```

### ❌ 问题4：看不到数据

**解决**：
1. 检查History和Budget表是否有数据
2. 临时切换到简单模式：
   ```python
   # 在 config.py 中
   USE_DB_ROLES = False
   ```

---

## 📁 项目文件说明

```
d:\数据库\小组大作业\
├── 📄 大作业.sql                    # 主数据库文件（必须先执行）
├── 📄 创建用户和权限.sql             # MySQL用户创建脚本（必须执行）
├── 📄 MySQL用户权限配置指南.md       # 详细配置文档
├── 📄 项目说明.txt                   # 快速开始
├── 📄 使用说明.md                    # 答辩准备
└── 📁 app/                          # Streamlit应用
    ├── app.py                       # 主程序
    ├── config.py                    # 配置文件（已配置好）
    ├── requirements.txt             # 依赖列表
    └── ...
```

---

## 🎉 完成！

现在你的系统已经：
- ✅ 数据库完整导入
- ✅ MySQL用户权限配置完成
- ✅ 应用程序配置完成
- ✅ 可以立即演示

**立即测试：**
```powershell
cd "d:\数据库\小组大作业\app"
streamlit run app.py
```

在浏览器中打开，使用Manager/manager123登录，开始探索！

---

## 📞 需要帮助？

- 查看 `MySQL用户权限配置指南.md` 了解详细配置
- 查看 `使用说明.md` 准备答辩材料
- 检查每个文件的注释，都有详细说明

**祝答辩成功！🎊**
